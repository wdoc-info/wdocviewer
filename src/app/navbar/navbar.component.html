<aside class="sidenav" aria-label="Document navigation">
  <header class="sidenav-header">
    <div class="brand">
      <img src="assets/logo.svg" alt="WDOC logo" class="brand-logo" />
      <span class="brand-text">wdoc</span>
    </div>
    <button
      class="close-btn"
      (click)="onCloseNav()"
      aria-label="Close navigation"
    >
      &times;
    </button>
  </header>
  <div class="nav-content">
    <button type="button" class="nav-btn primary" (click)="onCreateNewDocument()">
      New document
    </button>
    <button type="button" class="nav-btn" (click)="triggerFileDialog()">
      Open .wdoc or .zip file
    </button>
    <input
      #fileInput
      type="file"
      class="sr-only"
      (change)="onFileChange($event)"
      accept=".wdoc,.zip"
      aria-hidden="true"
      tabindex="-1"
    />
  </div>
  <footer class="nav-footer">
    <button type="button" class="nav-btn auth-btn" (click)="openAuthModal()">
      <span class="auth-label">{{ currentUserEmail || 'Login / Sign up' }}</span>
    </button>
  </footer>

  <div class="modal-backdrop" *ngIf="isAuthModalOpen" (click)="closeAuthModal()">
    <div class="modal" role="dialog" aria-modal="true" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3 class="modal-title">Login or sign up</h3>
        <button type="button" class="modal-close" (click)="closeAuthModal()" aria-label="Close dialog">
          &times;
        </button>
      </div>
      <div class="modal-body">
        <ng-container *ngIf="!emailSent; else emailSentTemplate">
          <form class="auth-form" (ngSubmit)="onAuthSubmit()">
            <label class="input-label" for="auth-email">Email address</label>
            <input
              id="auth-email"
              name="email"
              type="email"
              [(ngModel)]="email"
              class="modal-input"
              placeholder="you@example.com"
              required
            />
            <p class="status-message" *ngIf="statusMessage">{{ statusMessage }}</p>
            <div class="modal-actions">
              <button
                type="submit"
                class="nav-btn full-width primary"
                [disabled]="isSubmitting"
              >
                {{ isSubmitting ? 'Sending...' : 'Send login link' }}
              </button>
            </div>
            <p class="hint">We will send a login or signup link to your email.</p>
          </form>
        </ng-container>
        <ng-template #emailSentTemplate>
          <p class="status-message">{{ statusMessage }}</p>
        </ng-template>
      </div>
    </div>
  </div>

  <div class="modal-backdrop" *ngIf="isSettingsModalOpen" (click)="closeSettingsModal()">
    <div class="modal" role="dialog" aria-modal="true" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3 class="modal-title">Account settings</h3>
        <button
          type="button"
          class="modal-close"
          (click)="closeSettingsModal()"
          aria-label="Close dialog"
        >
          &times;
        </button>
      </div>
      <div class="modal-body">
        <p class="user-email" *ngIf="currentUserEmail">{{ currentUserEmail }}</p>
      </div>
      <div class="modal-actions">
        <button
          type="button"
          class="nav-btn full-width"
          (click)="onLogout()"
          [disabled]="isSubmitting"
        >
          Log out
        </button>
      </div>
    </div>
  </div>
</aside>
